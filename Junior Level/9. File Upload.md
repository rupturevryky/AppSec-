–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ **–∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ —Å –ª—é–±–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞** –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –ö–∞–∫–∏–µ **–∞—Ç–∞–∫–∏ –º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Å—Ç–∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫** –∏ –∫–∞–∫ **–∑–∞—â–∏—â–∞—Ç—å—Å—è –æ—Ç —ç—Ç–∏—Ö –∞—Ç–∞–∫**?

---

## üî• –ê—Ç–∞–∫–∏ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–æ–≤

---

### üìÅ –ê—Ç–∞–∫–∏ —á–µ—Ä–µ–∑ –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤

#### 1.¬†**–ó–∞–≥—Ä—É–∑–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤**

- **Web Shell**: –ó–∞–≥—Ä—É–∑–∫–∞ PHP, JSP, ASP —Ñ–∞–π–ª–æ–≤ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è RCE

```php
<?php system($_GET['cmd']); ?>
```
- **–û–±—Ä–∞—Ç–Ω—ã–µ —à–µ–ª–ª—ã**: –§–∞–π–ª—ã, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—â–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- **–ú–∞–ª–∏—Ü–∏–æ–∑–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã**: Python, Node.js, Bash —Å–∫—Ä–∏–ø—Ç—ã

**–ú–∞–ª–∏—Ü–∏–æ–∑–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã**¬†‚Äî —ç—Ç–æ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –º–∞—Å–∫–∏—Ä—É—è –∏—Ö –ø–æ–¥ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ —Ñ–∞–π–ª—ã (—á–∞—Å—Ç–æ –ø–æ–¥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è), —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –ü–æ–¥—Ä–æ–±–Ω–µ–µ: [[9.1. –ü—Ä–∏–º–µ—Ä—ã –º–∞–ª–∏—Ü–∏–æ–∑–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤]].

##### üö®¬†**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–∞–ª–∏—Ü–∏–æ–∑–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤**

- **–ò—Å–ø–æ–ª–Ω—è–µ–º—ã–µ shebang —Å—Ç—Ä–æ–∫–∏**¬†(`#!/bin/bash`,¬†`#!/usr/bin/env python`)
- **–ò–º–ø–æ—Ä—Ç –æ–ø–∞—Å–Ω—ã—Ö –º–æ–¥—É–ª–µ–π**¬†(`os`,¬†`subprocess`,¬†`child_process`,¬†`socket`)
- **–ü–æ–ø—ã—Ç–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º —Ñ–∞–π–ª–∞–º**¬†(`/etc/passwd`,¬†`/root/.ssh`)
- **–°–µ—Ç–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**¬†(—Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤, –æ–±—Ä–∞—Ç–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)
- **–ü–æ–ø—ã—Ç–∫–∏ —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π**¬†(SUID, cron jobs)

#### 2.¬†**–ê—Ç–∞–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π**

- **–ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏**: –û–≥—Ä–æ–º–Ω—ã–µ —Ñ–∞–π–ª—ã (>100MB)
- **Zip-bombs**: –ê—Ä—Ö–∏–≤—ã, —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞—é—â–∏–µ—Å—è –≤ —Ç–µ—Ä–∞–±–∞–π—Ç—ã –¥–∞–Ω–Ω—ã—Ö
- **Decompression bombs**: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –æ–≥—Ä–æ–º–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

#### 3.¬†**–û–±—Ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–æ–∫ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞**

- **–ü–æ–¥–º–µ–Ω–∞ MIME-type**:¬†`image/jpeg`¬†–¥–ª—è PHP —Ñ–∞–π–ª–∞
- **–ú–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ JPEG –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∫ —Å–∫—Ä–∏–ø—Ç–∞–º
- **–î–≤–æ–π–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è**:¬†`avatar.jpg.php`

---

### üåê –ê—Ç–∞–∫–∏ —á–µ—Ä–µ–∑ URL-–∑–∞–≥—Ä—É–∑–∫—É (SSRF –≤–µ–∫—Ç–æ—Ä—ã)

#### 4.¬†**Server-Side Request Forgery (SSRF)**

```http
# –î–æ—Å—Ç—É–ø –∫ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º –æ–±–ª–∞–∫–∞
http://169.254.169.254/latest/meta-data/

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏
http://192.168.1.1:8080/admin
http://localhost:3306

# –ß—Ç–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
file:///etc/passwd
```

#### 5.¬†**Port Scanning —á–µ—Ä–µ–∑ —Ç–∞–π–º–∞—É—Ç—ã**

- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞
- –ö–∞—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏

---

### üñºÔ∏è –ê—Ç–∞–∫–∏ —á–µ—Ä–µ–∑ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

#### 6.¬†**Polyglot —Ñ–∞–π–ª—ã**

- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ + JavaScript**: SVG —Å –≤–Ω–µ–¥—Ä–µ–Ω–Ω—ã–º JS
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ + PHP**: JPEG —Å PHP –∫–æ–¥–æ–º –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- **PDF + Flash**: –ú–Ω–æ–≥–æ—Ñ–æ—Ä–º–∞—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã

#### 7.¬†**EXIF/–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∞—Ç–∞–∫–∏**

- **XSS —á–µ—Ä–µ–∑ EXIF**:¬†`<script>alert('XSS')</script>`¬†–≤ –ø–æ–ª–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è

#### 8.¬†**–ê—Ç–∞–∫–∏ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**

- **ImageTragick**: –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ ImageMagick
- **–î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è**: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **Buffer overflows**: –ö–æ—Ä—Ä—É–º–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

---

### üéØ –ê—Ç–∞–∫–∏ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

#### 9.¬†**XSS —á–µ—Ä–µ–∑ SVG**

```svg
<svg xmlns="http://www.w3.org/2000/svg">
  <script>alert('XSS')</script>
</svg>
```

#### 10.¬†**CSRF —á–µ—Ä–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –ø—Ä–æ—Ñ–∏–ª—è
- –í—ã–∑–æ–≤ –¥–µ–π—Å—Ç–≤–∏–π –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### 11.¬†**–§–∏—à–∏–Ω–≥ —á–µ—Ä–µ–∑ –ø–æ–¥–¥–µ–ª—å–Ω—ã–µ –∞–≤–∞—Ç–∞—Ä—ã**

- –ü–æ–¥–¥–µ–ª–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –°–æ—Ü–∏–∞–ª—å–Ω–∞—è –∏–Ω–∂–µ–Ω–µ—Ä–∏—è —á–µ—Ä–µ–∑ –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç

---

## üõ°Ô∏è –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞

### üîí –£—Ä–æ–≤–µ–Ω—å 1: –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫)
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ MIME type
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ magic numbers
4. –£–¥–∞–ª–µ–Ω–∏–µ EXIF –¥–∞–Ω–Ω—ã—Ö
5. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞
   ```nginx
	# Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
	client_max_body_size 2M;
	```
6. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —Å–∞–Ω–∞—Ü–∏—è: –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∏ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ. –£–¥–∞–ª–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.
7. –ó–∞–ø—É—Å–∫ –≤ sandbox'–µ
8. **Content Disposition Header**
   ```python
	# –ó–∞–ø—Ä–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
	response.headers['Content-Disposition'] = 'attachment; filename="image.jpg"'
	response.headers['X-Content-Type-Options'] = 'nosniff'
	```
### üîí –£—Ä–æ–≤–µ–Ω—å 2: –ó–∞—â–∏—Ç–∞ –æ—Ç SSRF - –í–∞–ª–∏–¥–∞—Ü–∏—è URL
### üîí –£—Ä–æ–≤–µ–Ω—å 4: –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

#### –ò–∑–æ–ª—è—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:

```nginx
# –§–∞–π–ª—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–µ—Ä–≤–µ—Ä
location /uploads/ {
    root /var/www/static;
    add_header Content-Type "image/jpeg";
    # –ó–∞–ø—Ä–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    location ~ \.(php|pl|py|jsp)$ {
        deny all;
    }
}
```
#### –•—Ä–∞–Ω–µ–Ω–∏–µ –≤–Ω–µ webroot:

```
/var/www/html/          # Web root
/var/www/uploads/       # –§–∞–π–ª—ã (–≤–Ω–µ –¥–æ—Å—Ç—É–ø–Ω–æ–π –∑–æ–Ω—ã)
```

### üîí –£—Ä–æ–≤–µ–Ω—å 5: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π:
```python
def detect_upload_anomalies(file_info, user_agent):
    alerts = []
    
    # –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ User-Agent
    suspicious_agents = ['curl', 'wget', 'nikto', 'sqlmap']
    if any(agent in user_agent.lower() for agent in suspicious_agents):
        alerts.append("Suspicious User-Agent")
    
    # –ù–µ–æ–±—ã—á–Ω–æ –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã
    if file_info['size'] > 10 * 1024 * 1024:  # 10MB
        alerts.append("Oversized upload attempt")
    
    # –ß–∞—Å—Ç—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏
    upload_count = get_user_upload_count(user_id)
    if upload_count > 10:  # per hour
        alerts.append("Upload rate limit exceeded")
    
    return alerts
```

## üìã –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### Web Application Firewall (WAF) –ø—Ä–∞–≤–∏–ª–∞:

```json
{
    "file_upload": {
        "max_file_size": "2MB",
        "allowed_extensions": ["jpg", "jpeg", "png"],
        "scan_uploaded_files": true,
        "block_executable_content": true
    }
}
```

### Content Security Policy:

```http
Content-Security-Policy: default-src 'self'; img-src 'self' data:; script-src 'self'
```

---

## üö® –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –º–µ—Ä—ã

### –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∑–∞–≥—Ä—É–∑–∫–∏**
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏**
3. **–û—Ç–æ–∑–≤–∞—Ç—å –≤—Å–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞**
4. **–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≤–µ–±-—à–µ–ª–ª–æ–≤**

### –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞:

```text
–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ ‚Üí –ò–∑–æ–ª—è—Ü–∏—è ‚Üí –ê–Ω–∞–ª–∏–∑ ‚Üí –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Üí –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞
```